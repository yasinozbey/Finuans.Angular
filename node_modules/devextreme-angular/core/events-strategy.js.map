{"version":3,"file":"events-strategy.js","sourceRoot":"","sources":["events-strategy.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAaA,sCAAqD;AAOrD,IAAA;IAII,0BAAoB,MAAc,EAAU,QAAa;QAArC,WAAM,GAAN,MAAM,CAAQ;QAAU,aAAQ,GAAR,QAAQ,CAAK;6BAHQ,EAAE;sBACZ,EAAE;KAEK;IAE9D,mCAAQ,GAAR,UAAS,IAAY;QACjB,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,MAAM,CAAC;KACjD;IAED,oCAAS,GAAT,UAAU,IAAI,EAAE,IAAI;QAChB,IAAI,OAAO,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;QACpC,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC;YAC3B,EAAE,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC;gBACvB,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,cAAM,OAAA,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,EAA7B,CAA6B,CAAC,CAAC;aACxD;YAAC,IAAI,CAAC,CAAC;gBACJ,OAAO,CAAC,IAAI,CAAC,IAAI,IAAI,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;aACjC;SACJ;KACJ;IAED,6BAAE,GAAF,UAAG,IAAI,EAAE,OAAO;QACZ,IAAI,kBAAkB,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,EACnD,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAC1E,WAAW,GAAG,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;QAE5D,kBAAkB,CAAC,IAAI,CAAC,EAAE,OAAO,SAAA,EAAE,WAAW,aAAA,EAAE,CAAC,CAAC;QAClD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,kBAAkB,CAAC;KACjD;IAED,8BAAG,GAAH,UAAI,IAAI,EAAE,OAAO;QACb,IAAI,kBAAkB,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;QAExD,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACV,kBAAkB,CAAC,IAAI,CAAC,UAAC,YAAY,EAAE,CAAC;gBACpC,EAAE,CAAC,CAAC,YAAY,CAAC,OAAO,KAAK,OAAO,CAAC,CAAC,CAAC;oBACnC,YAAY,CAAC,WAAW,EAAE,CAAC;oBAC3B,kBAAkB,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;oBAChC,MAAM,CAAC,IAAI,CAAC;iBACf;aACJ,CAAC,CAAC;SACN;QAAC,IAAI,CAAC,CAAC;YACJ,kBAAkB,CAAC,OAAO,CAAC,UAAA,YAAY;gBACnC,YAAY,CAAC,WAAW,EAAE,CAAC;aAC9B,CAAC,CAAC;YACH,kBAAkB,CAAC,MAAM,CAAC,CAAC,EAAE,kBAAkB,CAAC,MAAM,CAAC,CAAC;SAC3D;KACJ;IAED,kCAAO,GAAP,eAAY;IAEL,qCAAU,GAAjB,UAAkB,SAAiB,EAAE,OAA0B;QAC3D,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,OAAO,CAAC;KACpC;IAEO,qCAAU,GAAlB,UAAmB,SAAiB;QAChC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;YAC1B,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,IAAI,mBAAY,EAAE,CAAC;SAC/C;QACD,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;KACjC;2BAhFL;IAiFC,CAAA;AA7DY,4CAAgB;AA+D7B,IAAA;IAGI,uBAAoB,SAAsB;QAAtB,cAAS,GAAT,SAAS,CAAa;sCAFjB,KAAK;KAEiB;IAE/C,mCAAW,GAAX,UAAY,SAAiB,EAAE,SAAc;QACzC,EAAE,CAAC,CAAC,IAAI,CAAC,sBAAsB,IAAI,SAAS,KAAK,aAAa,CAAC,CAAC,CAAC;YAC7D,MAAM,CAAC;SACV;QACD,IAAI,OAAO,GAAG,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QACxC,EAAE,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC;YACV,OAAO,CAAC,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;SAC3C;KACJ;IAED,sCAAc,GAAd,UAAe,MAAa;QAA5B,iBAIC;QAHG,MAAM,CAAC,OAAO,CAAC,UAAA,KAAK;YAChB,KAAI,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,IAAI,mBAAY,EAAE,CAAC;SACnD,CAAC,CAAC;KACN;wBAtGL;IAuGC,CAAA;AApBY,sCAAa","sourcesContent":["/*!\n * devextreme-angular\n * Version: 18.1.4\n * Build date: Thu Jun 21 2018\n *\n * Copyright (c) 2012 - 2018 Developer Express Inc. ALL RIGHTS RESERVED\n *\n * This software may be modified and distributed under the terms\n * of the MIT license. See the LICENSE file in the root of the project for details.\n *\n * https://github.com/DevExpress/devextreme-angular\n */\n\nimport { EventEmitter, NgZone } from '@angular/core';\r\nimport { DxComponent } from './component';\r\n\r\ninterface IEventSubscription {\r\n    handler: any;\r\n    unsubscribe: () => void;\r\n}\r\nexport class NgEventsStrategy {\r\n    private subscriptions: { [key: string]: IEventSubscription[] } = {};\r\n    private events: { [key: string]: EventEmitter<any> } = {};\r\n\r\n    constructor(private ngZone: NgZone, private instance: any) { }\r\n\r\n    hasEvent(name: string) {\r\n        return this.getEmitter(name).observers.length;\r\n    }\r\n\r\n    fireEvent(name, args) {\r\n        let emitter = this.getEmitter(name);\r\n        if (emitter.observers.length) {\r\n            if (this.ngZone.isStable) {\r\n                this.ngZone.run(() => emitter.next(args && args[0]));\r\n            } else {\r\n                emitter.next(args && args[0]);\r\n            }\r\n        }\r\n    }\r\n\r\n    on(name, handler) {\r\n        let eventSubscriptions = this.subscriptions[name] || [],\r\n            subcription = this.getEmitter(name).subscribe(handler.bind(this.instance)),\r\n            unsubscribe = subcription.unsubscribe.bind(subcription);\r\n\r\n        eventSubscriptions.push({ handler, unsubscribe });\r\n        this.subscriptions[name] = eventSubscriptions;\r\n    }\r\n\r\n    off(name, handler) {\r\n        let eventSubscriptions = this.subscriptions[name] || [];\r\n\r\n        if (handler) {\r\n            eventSubscriptions.some((subscription, i) => {\r\n                if (subscription.handler === handler) {\r\n                    subscription.unsubscribe();\r\n                    eventSubscriptions.splice(i, 1);\r\n                    return true;\r\n                }\r\n            });\r\n        } else {\r\n            eventSubscriptions.forEach(subscription => {\r\n                subscription.unsubscribe();\r\n            });\r\n            eventSubscriptions.splice(0, eventSubscriptions.length);\r\n        }\r\n    }\r\n\r\n    dispose() {}\r\n\r\n    public addEmitter(eventName: string, emitter: EventEmitter<any>) {\r\n        this.events[eventName] = emitter;\r\n    }\r\n\r\n    private getEmitter(eventName: string): EventEmitter<any> {\r\n        if (!this.events[eventName]) {\r\n            this.events[eventName] = new EventEmitter();\r\n        }\r\n        return this.events[eventName];\r\n    }\r\n}\r\n\r\nexport class EmitterHelper {\r\n    lockedValueChangeEvent = false;\r\n\r\n    constructor(private component: DxComponent) { }\r\n\r\n    fireNgEvent(eventName: string, eventArgs: any) {\r\n        if (this.lockedValueChangeEvent && eventName === 'valueChange') {\r\n            return;\r\n        }\r\n        let emitter = this.component[eventName];\r\n        if (emitter) {\r\n            emitter.next(eventArgs && eventArgs[0]);\r\n        }\r\n    }\r\n\r\n    createEmitters(events: any[]) {\r\n        events.forEach(event => {\r\n            this.component[event.emit] = new EventEmitter();\r\n        });\r\n    }\r\n}\r\n\r\n"]}